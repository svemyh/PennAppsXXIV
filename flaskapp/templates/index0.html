<!doctype html>
<html lang=”en”>
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Name of your awesome camera app -->
    <title>Camera App</title>

<style>
html, body{
    margin: 0;
    height: 100vh; /* Make sure the body takes up the full viewport height */
    display: flex;
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
}


#camera, #camera--view, #camera--sensor, #camera--output{
    position: absolute;
    height: 75%;
    object-fit: cover;
    justify-content: center;
    align-items: center;
}

/* Styles for desktop PCs with a minimum width of 768px */
@media (min-width: 768px) {
    #camera, #camera--view, #camera--sensor, #camera--output {
        padding-left: -15%;
        padding-right: 38%;
    }
}

#camera--trigger{
    width: 200px;
    background-color: black;
    color: white;
    font-size: 16px;
    border-radius: 30px;
    border: none;
    padding: 15px 20px;
    text-align: center;
    box-shadow: 0 5px 10px 0 rgba(0,0,0,0.2);
    position: fixed;
    bottom: 30px;
    left: calc(50% - 100px);
}


/* Styles for mobile devices with a maximum width of 767px */
@media (max-width: 767px) {
    #camera, #camera--view, #camera--sensor, #camera--output {
        left: 0;
    }

    #camera--trigger{
    width: 200px;
    background-color: black;
    color: white;
    font-size: 16px;
    border-radius: 30px;
    border: none;
    padding: 15px 20px;
    text-align: center;
    box-shadow: 0 5px 10px 0 rgba(0,0,0,0.2);
    position: fixed;
    bottom: 30px;
    left: calc(50% - 100px);
    }
}



.taken{
    height: 100px!important;
    width: 100px!important; 
    border: solid 3px white;
    box-shadow: 0 5px 10px 0 rgba(0,0,0,0.2);
    top: 20px;
    right: 20px;
    z-index: 2;
}

</style>

</head>
<body>
<!-- Camera -->

<main id="camera">
        
<!-- Camera sensor -->
<canvas id="camera--sensor"></canvas>

<!-- Camera view -->
<video id="camera--view" autoplay playsinline></video>

<!-- Camera output -->
<img src="//:0" alt="" id="camera--output">

<!-- Camera trigger -->
<button id="camera--trigger">Take a picture</button>    

</main>    



<script>
// Set constraints for the video stream
var constraints = { video: { facingMode: "user" }, audio: false };// Define constants
const cameraView = document.querySelector("#camera--view"),
    cameraOutput = document.querySelector("#camera--output"),
    cameraSensor = document.querySelector("#camera--sensor"),
    cameraTrigger = document.querySelector("#camera--trigger")// Access the device camera and stream to cameraView
function cameraStart() {
    navigator.mediaDevices
        .getUserMedia(constraints)
        .then(function(stream) {
        track = stream.getTracks()[0];
        cameraView.srcObject = stream;
    })
    .catch(function(error) {
        console.error("Oops. Something is broken.", error);
    });
}// Take a picture when cameraTrigger is tapped
cameraTrigger.onclick = function() {
    cameraSensor.width = cameraView.videoWidth;
    cameraSensor.height = cameraView.videoHeight;
    cameraSensor.getContext("2d").drawImage(cameraView, 0, 0);
    cameraOutput.src = cameraSensor.toDataURL("image/webp");
    cameraOutput.classList.add("taken");
};// Start the video stream when the window loads
window.addEventListener("load", cameraStart, false);

</script>


<script>
    // ... (existing code)
    
    // Function to send the captured image to the backend
    function sendImageToServer(imageData) {
        // Define the URL of your backend endpoint
        const serverEndpoint = 'https://example.com/upload'; // Replace with your actual backend URL
    
        // Create a FormData object to send the image as a file
        const formData = new FormData();
        formData.append('image', imageData);
    
        // Send a POST request to the backend
        fetch(serverEndpoint, {
            method: 'POST',
            body: formData
        })
        .then(response => {
            if (response.ok) {
                console.log('Image sent successfully');
                // You can perform additional actions here if needed
            } else {
                console.error('Failed to send image to the server');
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    }
    
    // Take a picture when cameraTrigger is tapped
    cameraTrigger.onclick = function() {
        cameraSensor.width = cameraView.videoWidth;
        cameraSensor.height = cameraView.videoHeight;
        cameraSensor.getContext("2d").drawImage(cameraView, 0, 0);
        const imageDataURL = cameraSensor.toDataURL("image/jpeg"); // You can change the format if needed
        cameraOutput.src = imageDataURL;
        cameraOutput.classList.add("taken");
    
        // Call the function to send the image to the server
        sendImageToServer(dataURLtoBlob(imageDataURL)); // Convert data URL to Blob
    };
    
    // Function to convert a data URL to Blob
    function dataURLtoBlob(dataURL) {
        const parts = dataURL.split(';base64,');
        const contentType = parts[0].split(':')[1];
        const raw = window.atob(parts[1]);
        const blob = new Blob([new Uint8Array(Array.from(raw).map(char => char.charCodeAt(0)))], { type: contentType });
        return blob;
    }
    
    // ... (existing code)
    </script>
    


</body>


</html>